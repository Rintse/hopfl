# Builtin function definitions for common list operations
let
    
# Coinductive list construction
cons â† ( Î» e . Î» l . inR ( e, l ) ) ;

# Basic functions
head    â† ( Î» l . match l { inL x â†’ x ; inR y â†’ fst y } ) ;
tail    â† ( Î» l . match l { inL x â†’ x ; inR y â†’ snd y } ) ;
null    â† ( Î» l . match l { inL x â†’ true ; inR y â†’ false } ) ;

length  â† ( fix f . Î» l .
    match l {
        inL x â†’ 0 ;
        inR y â†’ 1 + prevI ( f âŠ™ next ( snd y ) )
    }
) ;

append  â† ( fix f . Î» l1 . Î» l2 .
    match l1 {
        inL end â†’ l2 ;
        inR lst â†’ inR ( fst lst, prevI (
            f âŠ™ next (snd lst) âŠ™ next l2
        ) )
    }
) ;

take    â† ( fix f . Î» n . Î» l . 
    match l {
        inL x â†’ l ;
        inR y â†’ if (n = 0)
            then inL ğŸ™
            else inR ( fst y, prevI ( f âŠ™ next (n-1) âŠ™ next (snd y) ) )
    }
) ;


# Tranformations
map     â† ( fix f . Î» func . Î» list .
    match list {
        inL end â†’ list ;
        inR lst â†’ inR ( func ( fst lst ), prevI (
            f âŠ™ next func âŠ™ next ( snd lst )
        ) )
    }
) ;


# Folds
foldl   â† ( fix f . Î» func . Î» val . Î» list .
    match ( list ) {
        inL end â†’ val ;
        inR lst â†’ prevI ( 
            f âŠ™ next func 
              âŠ™ next ( func ( fst lst ) val )
              âŠ™ next ( snd lst )
        )
    }
) ;

foldr   â† ( fix f . Î» func . Î» val . Î» list .
    match ( list ) {
        inL end â†’ val ;
        inR lst â†’ func ( prevI ( 
            f âŠ™ next func 
              âŠ™ next ( val )
              âŠ™ next ( snd lst )
        ) ) ( fst lst )
    }
) ;

in: builtin
