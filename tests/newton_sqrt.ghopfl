# Estimates the sqrt of a given number using newtons method
# in an infitie approximation stream.
# Free variables to pass through the environment:
#   x:      The number to take the square root of
#   idx:    The iteration to take from the stream

let
    # Newtons method to update a guess
    update ← ( λ guess . 0.5 * ( guess + ( x / guess ) ) ) ;
    
    # A stream of closer and closer approximations
    approx_stream ← ( 
        ( fix f . λ guess . 
            in ( [ guess, f ⊙ next ( update guess ) ] )
        ) x # Simply take x to be the initial guess
    ) ;

    # Get the requested idx
    getIdx ← (
        fix f . λ idx . λ rw . if ( idx = 0 ) 
            then fst ( out rw )
            else prevI ( f ⊙ next ( idx - 1 ) ⊙ ( snd ( out rw ) ) )
    )

in: print ( (getIdx idx) approx_stream )
