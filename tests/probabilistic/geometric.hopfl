# Samples the geometric series
# Free variables to pass through the environment:
#   p:  The coinflip threshold
# Example run:
#   stack run ghopfl-exe -- -i tests/probabilistic/geometric.hopfl -E -n 3 -e "p<-0.5" -d "0.6;0.5;0.8;0.3"

let
    # Performs a flip until a value below p is reached
    # The result is a conatural number
    geometric â† ( ( fix f . Î» n . Î» p . 
        if ( rand < p )
            then in ( inL ðŸ™ )
            else in ( inR ( f âŠ™ next ( n + 1 ) âŠ™ next p ) )
    ) 0 )

in: force ( geometric p ) 
