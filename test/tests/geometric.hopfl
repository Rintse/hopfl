# Geometric series function

# Extracts the computed value from the coproduct
( fix f . λ x . match (out x) {
    left -> left; 
    right -> f ⊙ right
} )

# Performs a flip until a value below p is reached
( ( λ flip . λ p . ((fix f . λ n . 
    if flip p
    then in (inL n)
    else in (inR (f ⊙ next (n + 1.0)))) 0.0)
)
# Flip function (using simulated [0,1] with normal)
( λ p . (normal [0.5, 0.25]) < p ) p )
