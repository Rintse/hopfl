# Geometric series function
# Example run:
# -e "p=0.2" 5 "0.7,0.6,0.55,0.4,0.1" test/tests/geometric.hopfl 

( λ flip . λ p . ((fix f . λ n . 
    if flip p
    then in (inL n)
    else in (inR (f ⊙ next (n + 1.0)))) 0.0)
)

# Flip function (using simulated [0,1] with normal)
( λ p . (normal [0.5, 0.25]) < p )

# p supplied by user
p
